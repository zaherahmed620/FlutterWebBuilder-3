# دليل نشر تطبيق Flutter على استضافة cPanel

هذا الدليل يشرح خطوات نشر تطبيق Flutter Web على استضافة cPanel.

## الخطوة 1: بناء وتجهيز ملفات الويب

1. في بيئة Replit، قم بتنفيذ السكريبت التالي لبناء إصدار الويب من تطبيق Flutter:

```bash
./build_for_cpanel.sh
```

2. هذا السكريبت سيقوم بما يلي:
   - بناء إصدار الويب من التطبيق
   - إنشاء ملف `.htaccess` ضروري للتوجيه الصحيح
   - إنشاء ملف مضغوط `web.zip` يحتوي على كل الملفات المطلوبة

3. قم بتنزيل ملف `web.zip` من Replit إلى جهازك.

## الخطوة 2: رفع الملفات إلى cPanel

1. سجل دخولك إلى لوحة تحكم cPanel.

2. افتح مدير الملفات File Manager.

3. انتقل إلى المجلد الذي تريد نشر التطبيق فيه (عادة `public_html` أو مجلد فرعي مثل `public_html/app`).

4. انقر على زر "Upload" ثم قم برفع ملف `web.zip`.

5. بعد اكتمال الرفع، اضغط بزر الفأرة الأيمن على الملف واختر "Extract".

6. تأكد من استخراج الملفات مباشرة في المجلد الذي اخترته (وليس في مجلد فرعي جديد).

## الخطوة 3: التحقق من ملف .htaccess

1. في مدير الملفات، تأكد من وجود ملف `.htaccess` في المجلد الذي رفعت إليه التطبيق.

2. إذا لم يكن موجوداً، قم بإنشائه يدوياً بالمحتوى التالي:

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # إذا كان الطلب ليس لملف أو مجلد موجود بالفعل
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # قم بإعادة توجيه جميع الطلبات إلى index.html
    RewriteRule ^ index.html [L]
</IfModule>

# تعيين MIME type لملفات Flutter
AddType application/javascript .js
AddType application/wasm .wasm
```

## الخطوة 4: اختبار التطبيق

1. افتح متصفح الويب وانتقل إلى عنوان URL الخاص بموقعك.

2. إذا كنت قد رفعت الملفات إلى مجلد فرعي، استخدم المسار المناسب (مثل `https://yourdomain.com/app`).

## استكشاف الأخطاء وإصلاحها

إذا واجهتك مشاكل في تشغيل التطبيق، تحقق مما يلي:

1. **مشاكل التوجيه**: تأكد من تمكين mod_rewrite في استضافة cPanel. يمكنك التواصل مع دعم الاستضافة للتأكد من ذلك.

2. **مشاكل CORS**: إذا كان التطبيق يتصل بـ API خارجي، تأكد من إعداد رؤوس CORS المناسبة في خادم API.

3. **مسار الأساس Base Path**: إذا كنت تستخدم مجلداً فرعياً، قد تحتاج إلى تعديل ملف `index.html` لتعيين مسار الأساس الصحيح. ابحث عن سطر `<base href="/">` وغيره إلى `<base href="/app/">` (استبدل "app" بمسار المجلد الفرعي الخاص بك).

4. **الأذونات Permissions**: تأكد من أن جميع الملفات لديها أذونات قراءة مناسبة (644 للملفات و 755 للمجلدات).

## ملاحظات إضافية

1. **ملفات API**: إذا كنت تستخدم PHP API في نفس الاستضافة، تأكد من وضع ملفات API في المجلد المناسب وتكوين مسار API الصحيح في تطبيق Flutter.

2. **تحديث التطبيق**: عند تحديث التطبيق، كرر الخطوات السابقة لبناء ورفع النسخة الجديدة.

3. **المجال الفرعي Subdomain**: إذا كنت ترغب في استخدام مجال فرعي للتطبيق (مثل `app.yourdomain.com`)، قم بإنشاء المجال الفرعي أولاً من لوحة تحكم cPanel، ثم قم برفع الملفات إلى المجلد المرتبط به.

4. **الأمان**: تذكر تحديث مفاتيح API والبيانات الحساسة في التطبيق قبل النشر للإنتاج.

5. **النسخ الاحتياطي**: احتفظ دائماً بنسخة احتياطية من ملفات التطبيق وقواعد البيانات قبل إجراء أي تحديثات كبيرة.